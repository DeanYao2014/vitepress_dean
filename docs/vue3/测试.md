# 用于测试CSV文件

<script setup>
import { ref, onMounted } from 'vue';
import * as XLSX from 'xlsx';

const excelData = ref(null);

onMounted(async () => {
    console.log('@@', "读取文件")
    const response = await fetch('./副本嘉善管点管线字典.xlsx');
    const arrayBuffer = await response.arrayBuffer();

        // 使用 XLSX 解析 Excel 文件
    const workbook = XLSX.read(arrayBuffer, { type: 'array' });
    console.log('@@@@@@@@@@workbook', workbook);
    // 假设文件中的第一个工作表是我们想要读取的表格
    const sheetName = workbook.SheetNames[0];
    const sheet = workbook.Sheets[sheetName];
    console.log('@@@@@@@@@@sheet', sheet);
    // 将工作表转换为 JSON
    excelData.value = XLSX.utils.sheet_to_json(sheet);
})
</script>


以下用于显示 数据

<div v-if="excelData">
    <table>
      <thead>
        <tr>
          <th v-for="(header, index) in Object.keys(excelData[0])" :key="index">
            {{ header }}
          </th>
        </tr>
      </thead>
      <tbody>
        <tr v-for="(row, index) in excelData" :key="index">
          <td v-for="(value, key) in row" :key="key">{{ value }}</td>
        </tr>
      </tbody>
    </table>
  </div>
  <div v-else>Loading...</div>